
# Data File Tree
```
data/.
├── Auditory_cortex_data
│   ├── 031020_367n_100um20st_FRA
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 031020_367r_100um20st_FRA
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 031120_352ll_100um20st_FRA
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 031120_352ll_100um20st_FRA_diffxy
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 080720_400r
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 081820_355n
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 081920_355l
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 081920_355r
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── 082620_355l
│   │   └── allPlanesVariables27-Feb-2021.mat
│   ├── ant.m
│   └── README.txt
└── Auditory_cortex_data.zip

11 directories, 12 files
```

# Original Instructions
This is the calcium imaging data set generated by Bowen et al., "Fractured columnar small-world functional network organization in volumes of L2/3 of mouse auditory cortex," PNAS Nexus, Volume 3, Issue 2, February 2024, pgae074, https://doi.org/10.1093/pnasnexus/pgae074

There are 9 folders each with a file named 'allPlanesVariables27-Feb-2021.mat' containing neuron activity. These files are MATLAB files.

We include a MATLAB script, ant.m, to exemplify how to graph the planes containing the neurons and their activity.

Example on how to interpret the variables stored in
'allPlanesVariables27-Feb-2021.mat'

In each 'allPlanesVariables27-Feb-2021.mat' MATLAB file you will find
several cell arrays with 7 entries correpsonding to the 7 imaging
z-planes. The relevant cell arrays are allxc, allyc, allzc, and zDFF.

The cell arrays allxc, allyc, allzc store 7 planes of microscope data and
together they indicate the (x,y,z) coordinates of each of the neurons
identified in the given plane. That is, allxc holds the x coordinates,
allyc, the y coordinates, and allzc the z coordinates, for each neuron in
that plane.

You should ignore planes 1 and 7 as they are affected by fly-back frames.

The cell array zDFF stores for each neuron in each plane its activity as
a function of time.

The following code graphs planes 2 through 6 in a 3D-graph showing the
location of each neuron in figures 2 through 6. Figure 1 shows the
activity of the first neuron of the plane 2.

Before running this script you should load any of the
'allPlanesVariables27-Feb-2021.mat' files with the load command.

For example:
load 081920_355l/allPlanesVariables27-Feb-2021.mat

## Keys of the mat file
```
__header__
__version__
__globals__
BFinfo
CellInfo
CorrInfo
allZCorrInfo
allxc
allyc
allzc
exptVars
selectZCorrInfo
stimInfo
zDFF
zStuff
__function_workspace__
```


# Methods
We presented tonal stimuli while imaging ∼1,000 neurons simultaneously to extract and analyze the topology of the functional networks within a cortical volume (∼370 × 370 × 100 µm). We found that volumes of L2/3 of the auditory cortex have a large diversity of tuning in relatively small volumes, yet still showed coarse spatial organization of similarly tuned neurons. Neurons were organized into microcolumns where neuronal tuning was similar with respect to depth but became dissimilar with respect to lateral distance away from the core of the columns. We constructed functional networks and found that functionally linked neurons were clustered in space, exhibited Rentian scaling, and that the functional network topology showed characteristics of small-world network organization. These two lines of evidence suggest that L2/3 auditory cortex neuronal networks fit characteristics of a cost-efficient organization, where functionally similar neurons are embedded in microcolumns while local tuning diversity is maintained, possibly to facilitate rapid plasticity and integration of information across the auditory cortex.


Data analysis
Two-photon image analysis
Two-photon image sequences were processed using methods previously described (19, 65). Image sequences were corrected for x–y drifts and movement artifacts using discrete Fourier transform registration (66) implemented in MATLAB (Mathworks). Neurons were identified manually from an average image across all motion-corrected images. Ring-like regions of interest (ROI) boundaries were programmatically drawn based on the method described by Chen et al. (67). Overlapping ROI pixels (due to closely juxtaposed neurons) were excluded from the analysis. For each selected neuron, a raw fluorescence signal over time (Fsoma) was extracted by averaging across pixels from the ROI overlying the soma. Neuropil (NP) correction was performed on the raw fluorescence of all soma ROIs (Fsoma) (68). In short, the NP ROI was drawn based on the outer boundary of the soma ROI and extended from one pixel beyond the soma ROI outer boundary to 15 μm, excluding any pixels assigned to neighboring somata. The resulting fluorescence intensity (F) used for analysis was calculated as F = Fsoma − (α×FNP), where we use a default value of α = 0.7 to reduce fluorescence contamination from the NP (68). The NP-corrected fluorescence for each neuron was then converted to a relative fluorescence amplitude (ΔF/F0), where ΔF = (F − F0). F0 was estimated using a sliding window approach that calculated the average fluorescence of points less than the 50th percentile in a 10-s sliding window, as similarly reported in previous studies (69, 70).

We tested the sensitivity of NP subtraction by investigating how fluorescent traces and pairwise correlations were altered at different NP subtraction coefficients. First, to investigate how individual neuronal traces are altered, we computed the self-similarity of ΔF/F traces at each level of NP subtraction. NP subtraction was performed at 11 different values (α = 0 to α = 1 at 0.1 intervals), and the correlation between ΔF/F traces from the same neuron at each α value was computed. ΔF/F traces were minimally altered with respect to the percentage of NP subtracted except at large differences (i.e. differences of 70% or greater) (Fig. S2A). Within the range of 60–90% NP subtracted, there was nearly no difference in ΔF/F traces as indicated by neuronal self-correlations centered on unity (Fig. S2A). Next, we aimed to investigate how pairwise correlations, as measured by similarities in tuning curves, were altered with respect to NP percent subtraction. We found that NP subtraction decreases pairwise correlations as expected, though the effect was minimal (Fig. S2B). The difference in SCs on a single neuron basis from 70 to 0% NP subtracted was −0.07± 0.17 (mean ±std), indicating a very small average decrease even at a large difference in NP subtracted. The difference in SCs is significantly smaller within the range of 60–90% subtraction (Fig. S2B). These results indicate that the amount of NP signal subtracted has an expected effect of lowering pairwise correlations, though the effect is very minimal.

Neuronal receptive fields and tuning
Neuronal tuning and responsiveness were assessed using methods described previously (19). Neurons in which the ΔF/F0 signal was significantly modulated by sound presentation (and deemed “responsive”) were defined by ANOVA (P < 0.01) across baseline (prestimulus) and all sound presentation periods. Neuron receptive fields (tuning curves) were determined as the average ΔF/F0 response during the stimulus presentation for each frequency across all stimulus repetitions. BF for each neuron was determined as the stimulus frequency that elicited the highest average ΔF/F0 response (peak of the tuning curve). To determine if a neuron was tuned or untuned, we computed a z-score from the tuning curve to find peaks that deviated significantly from the mean of the tuning curve. To isolate the most distinctly tuned neurons, tuned neurons were defined as the upper 30% quantile of the max z-score distribution from all responding neurons. The tuned/untuned distinction was only utilized for analyses of BF, whereas all correlation and functional networks made use of all responding neurons, regardless of how selectively tuned they were.
